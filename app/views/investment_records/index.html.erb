<div class="fade-in">
  <!-- Header -->
  <div class="flex items-center justify-between mb-8">
    <div>
      <h1 class="text-3xl font-bold text-gray-900 mb-2">투자 기록</h1>
      <p class="text-gray-600">나의 투자 내역을 관리하세요</p>
    </div>
    <div class="flex gap-3">
      <%= link_to import_investment_records_path, class: "btn-outline" do %>
        <i class="fas fa-upload mr-2"></i>CSV 업로드
      <% end %>
      <%= link_to new_investment_record_path, class: "btn-primary" do %>
        <i class="fas fa-plus mr-2"></i>기록 추가
      <% end %>
    </div>
  </div>

  <!-- Filters -->
  <div class="card mb-6">
    <div class="flex flex-wrap gap-4">
      <%= link_to "전체", investment_records_path, class: "px-4 py-2 rounded-lg #{params[:action_type].blank? ? 'bg-blue-600 text-white' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'}" %>
      <%= link_to "매수", investment_records_path(action_type: 'buy'), class: "px-4 py-2 rounded-lg #{params[:action_type] == 'buy' ? 'bg-blue-600 text-white' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'}" %>
      <%= link_to "매도", investment_records_path(action_type: 'sell'), class: "px-4 py-2 rounded-lg #{params[:action_type] == 'sell' ? 'bg-blue-600 text-white' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'}" %>
    </div>
  </div>

  <!-- Records Table -->
  <div class="card">
    <div class="table-container">
      <table>
        <thead>
          <tr>
            <th>날짜</th>
            <th>종목</th>
            <th>구분</th>
            <th class="text-right">수량</th>
            <th class="text-right">단가</th>
            <th class="text-right">금액</th>
            <th class="text-center">별점</th>
            <th class="text-center">관리</th>
          </tr>
        </thead>
        <tbody>
          <% @records.each do |record| %>
            <tr>
              <td class="text-gray-600"><%= record.traded_at.strftime("%Y-%m-%d") %></td>
              <td>
                <div class="font-semibold text-gray-900"><%= record.stock.name %></div>
                <div class="text-xs text-gray-500"><%= record.stock.symbol %></div>
              </td>
              <td>
                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium <%= record.action == 'buy' ? 'bg-blue-100 text-blue-800' : 'bg-red-100 text-red-800' %>">
                  <%= record.action == 'buy' ? '매수' : '매도' %>
                </span>
              </td>
              <td class="text-right text-gray-900"><%= number_with_delimiter(record.quantity) %>주</td>
              <td class="text-right text-gray-900"><%= number_to_currency(record.price, unit: '', precision: 0) %>원</td>
              <td class="text-right font-semibold text-gray-900"><%= number_to_currency(record.price * record.quantity, unit: '', precision: 0) %>원</td>
              <td class="text-center">
                <% if record.pre_rating %>
                  <div class="star-rating justify-center text-sm">
                    <% 5.times do |i| %>
                      <span class="star <%= i < record.pre_rating ? 'active' : '' %>"><%= i < record.pre_rating ? '★' : '☆' %></span>
                    <% end %>
                  </div>
                <% else %>
                  <span class="text-gray-400">-</span>
                <% end %>
              </td>
              <td class="text-center">
                <%= link_to edit_investment_record_path(record), class: "text-blue-600 hover:text-blue-800 mr-2" do %>
                  <i class="fas fa-edit"></i>
                <% end %>
                <%= button_to investment_record_path(record), method: :delete, class: "text-red-600 hover:text-red-800", data: { turbo_confirm: "정말 삭제하시겠습니까?" } do %>
                  <i class="fas fa-trash"></i>
                <% end %>
              </td>
            </tr>
          <% end %>

          <% if @records.empty? %>
            <tr>
              <td colspan="8" class="text-center text-gray-500 py-12">
                <i class="fas fa-inbox text-4xl text-gray-300 mb-4 block"></i>
                투자 기록이 없습니다.
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
</div>
